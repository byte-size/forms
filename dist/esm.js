import e from"vue";"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;var t,n=(function(e,t){e.exports=function(){var e="undefined"!=typeof window,t="undefined"!=typeof navigator,n=e&&("ontouchstart"in window||t&&navigator.msMaxTouchPoints>0)?["touchstart"]:["click"];function i(e){var t=e.event,n=e.handler;(0,e.middleware)(t)&&n(t)}function r(e,t){var r=function(e){var t="function"==typeof e;if(!t&&"object"!=typeof e)throw new Error("v-click-outside: Binding value must be a function or an object");return{handler:t?e:e.handler,middleware:e.middleware||function(e){return e},events:e.events||n,isActive:!(!1===e.isActive),detectIframe:!(!1===e.detectIframe)}}(t.value),a=r.handler,o=r.middleware,s=r.detectIframe;if(r.isActive){if(e["__v-click-outside"]=r.events.map((function(t){return{event:t,srcTarget:document.documentElement,handler:function(t){return function(e){var t=e.el,n=e.event,r=e.handler,a=e.middleware,o=n.path||n.composedPath&&n.composedPath();(o?o.indexOf(t)<0:!t.contains(n.target))&&i({event:n,handler:r,middleware:a})}({el:e,event:t,handler:a,middleware:o})}}})),s){var c={event:"blur",srcTarget:window,handler:function(t){return function(e){var t=e.el,n=e.event,r=e.handler,a=e.middleware;setTimeout((function(){var e=document.activeElement;"IFRAME"!==e.tagName||t.contains(e)||i({event:n,handler:r,middleware:a})}),0)}({el:e,event:t,handler:a,middleware:o})}};e["__v-click-outside"]=[].concat(e["__v-click-outside"],[c])}e["__v-click-outside"].forEach((function(t){var n=t.event,i=t.srcTarget,r=t.handler;return setTimeout((function(){e["__v-click-outside"]&&i.addEventListener(n,r,!1)}),0)}))}}function a(e){(e["__v-click-outside"]||[]).forEach((function(e){return e.srcTarget.removeEventListener(e.event,e.handler,!1)})),delete e["__v-click-outside"]}var o=e?{bind:r,update:function(e,t){var n=t.value,i=t.oldValue;JSON.stringify(n)!==JSON.stringify(i)&&(a(e),r(e,{value:n}))},unbind:a}:{};return{install:function(e){e.directive("click-outside",o)},directive:o}}()}(t={exports:{}},t.exports),t.exports);function i(e,t,n,i,r,a,o){try{var s=e[a](o),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(i,r)}function r(e,t,n,i,r,a,o,s,c,u){"boolean"!=typeof o&&(c=s,s=o,o=!1);const d="function"==typeof n?n.options:n;let l;if(e&&e.render&&(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,r&&(d.functional=!0)),i&&(d._scopeId=i),a?(l=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),t&&t.call(this,c(e)),e&&e._registeredComponents&&e._registeredComponents.add(a)},d._ssrRegister=l):t&&(l=o?function(e){t.call(this,u(e,this.$root.$options.shadowRoot))}:function(e){t.call(this,s(e))}),l)if(d.functional){const e=d.render;d.render=function(t,n){return l.call(n),e(t,n)}}else{const e=d.beforeCreate;d.beforeCreate=e?[].concat(e,l):[l]}return n}const a={name:"Notification",props:{name:{type:String,required:!0},message:{type:String,default:""}},data:function(){return{isVisible:!0}}};var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.isVisible?n("div",{attrs:{"data-ntfc":e.name}},[e._v(e._s(e.message))]):e._e()};o._withStripped=!0;const s=r({render:o,staticRenderFns:[]},undefined,a,undefined,false,undefined,!1,void 0,void 0,void 0);var c={name:"Loading",data:function(){return{isAlive:!0}},props:{state:{type:String,default:"loading"}}};!function(e,t){void 0===t&&(t={});var n=t.insertAt;if(e&&"undefined"!=typeof document){var i=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css","top"===n&&i.firstChild?i.insertBefore(r,i.firstChild):i.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}}("\n@keyframes blink-data-v-a97393d2 {\n0% {\n    opacity: 0.2;\n}\n20% {\n    opacity: 1;\n}\n100% {\n    opacity: 0.2;\n}\n}\nspan[data-v-a97393d2] {\n  animation-name: blink-data-v-a97393d2;\n  animation-duration: 1.5s;\n  animation-iteration-count: infinite;\n  animation-fill-mode: both;\n  height: 8px;\n  width: 8px;\n  background: #ddd;\n  border-radius: 999px;\n}\nspan[data-v-a97393d2]:nth-child(2) {\n  padding-left: 2px;\n  animation-delay: 0.2s;\n}\nspan[data-v-a97393d2]:nth-child(3) {\n  padding-left: 2px;\n  animation-delay: 0.4s;\n}\n");const u=c;var d=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.isAlive?n("div",{staticClass:"bs-form-loading"},["loading"===e.state?n("div",{staticStyle:{display:"flex","justify-content":"center","align-items":"center",height:"100%",width:"100%"}},e._l(3,(function(e){return n("span",{key:e})})),0):n("div",{staticStyle:{display:"flex","justify-content":"center","align-items":"center",height:"100%",width:"100%"}},[n("p",[e._v("âœ”")])])]):n("i",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{name:"loading"}})};d._withStripped=!0;const l=r({render:d,staticRenderFns:[]},undefined,u,"data-v-a97393d2",false,undefined,!1,void 0,void 0,void 0);var f=/^(?:submit|button|image|reset|file)$/i,v=/^(?:input|select|textarea|keygen)/i,m=/(\[[^\[\]]*\])/g;function p(e,t,n){if(0===t.length)return e=n;var i=t.shift(),r=i.match(/^\[(.+?)\]$/);if("[]"===i)return e=e||[],Array.isArray(e)?e.push(p(null,t,n)):(e._values=e._values||[],e._values.push(p(null,t,n))),e;if(r){var a=r[1],o=+a;isNaN(o)?(e=e||{})[a]=p(e[a],t,n):(e=e||[])[o]=p(e[o],t,n)}else e[i]=p(e[i],t,n);return e}function h(e,t,n){if(t.match(m)){p(e,function(e){var t=[],n=new RegExp(m),i=/^([^\[\]]*)/.exec(e);for(i[1]&&t.push(i[1]);null!==(i=n.exec(e));)t.push(i[1]);return t}(t),n)}else{var i=e[t];i?(Array.isArray(i)||(e[t]=[i]),e[t].push(n)):e[t]=n}return e}function y(e,t,n){return n=n.replace(/(\r)?\n/g,"\r\n"),n=(n=encodeURIComponent(n)).replace(/%20/g,"+"),e+(e?"&":"")+encodeURIComponent(t)+"="+n}var b=function(e,t){"object"!=typeof t?t={hash:!!t}:void 0===t.hash&&(t.hash=!0);for(var n=t.hash?{}:"",i=t.serializer||(t.hash?h:y),r=e&&e.elements?e.elements:[],a=Object.create(null),o=0;o<r.length;++o){var s=r[o];if((t.disabled||!s.disabled)&&s.name&&(v.test(s.nodeName)&&!f.test(s.type))){var c=s.name,u=s.value;if("checkbox"!==s.type&&"radio"!==s.type||s.checked||(u=void 0),t.empty){if("checkbox"!==s.type||s.checked||(u=""),"radio"===s.type&&(a[s.name]||s.checked?s.checked&&(a[s.name]=!0):a[s.name]=!1),null==u&&"radio"==s.type)continue}else if(!u)continue;if("select-multiple"!==s.type)n=i(n,c,u);else{u=[];for(var d=s.options,l=!1,m=0;m<d.length;++m){var p=d[m],b=t.empty&&!p.value,g=p.value||b;p.selected&&g&&(l=!0,n=t.hash&&"[]"!==c.slice(c.length-2)?i(n,c+"[]",p.value):i(n,c,p.value))}!l&&t.empty&&(n=i(n,c,""))}}}if(t.empty)for(var c in a)a[c]||(n=i(n,c,""));return n},g=["input","select","textarea","a[href]","button","[tabindex]","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])',"details>summary"],w=g.join(","),E="undefined"==typeof Element?function(){}:Element.prototype.matches||Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector;function k(e){return!(!F(e)||function(e){return function(e){return N(e)&&"radio"===e.type}(e)&&!function(e){if(!e.name)return!0;var t=function(e,t){for(var n=0;n<e.length;n++)if(e[n].checked&&e[n].form===t)return e[n]}((e.form||e.ownerDocument).querySelectorAll('input[type="radio"][name="'+e.name+'"]'),e.form);return!t||t===e}(e)}(e)||T(e)<0)}function F(e){return!(e.disabled||function(e){return N(e)&&"hidden"===e.type}(e)||function(e){return null===e.offsetParent||"hidden"===getComputedStyle(e).visibility}(e))}var x,_=g.concat("iframe").join(",");function S(e){if(!e)throw new Error("No node provided");return!1!==E.call(e,_)&&F(e)}function T(e){var t=parseInt(e.getAttribute("tabindex"),10);return isNaN(t)?function(e){return"true"===e.contentEditable}(e)?0:"AUDIO"!==e.nodeName&&"VIDEO"!==e.nodeName||null!==e.getAttribute("tabindex")?e.tabIndex:0:t}function A(e,t){return e.tabIndex===t.tabIndex?e.documentOrder-t.documentOrder:e.tabIndex-t.tabIndex}function N(e){return"INPUT"===e.tagName}
/*!
* focus-trap 6.0.1
* @license MIT, https://github.com/focus-trap/focus-trap/blob/master/LICENSE
*/var O,C=(O=[],{activateTrap:function(e){if(O.length>0){var t=O[O.length-1];t!==e&&t.pause()}var n=O.indexOf(e);-1===n||O.splice(n,1),O.push(e)},deactivateTrap:function(e){var t=O.indexOf(e);-1!==t&&O.splice(t,1),O.length>0&&O[O.length-1].unpause()}});function $(e,t){var n=document,i="string"==typeof e?n.querySelector(e):e,r={returnFocusOnDeactivate:!0,escapeDeactivates:!0,...t},a={firstTabbableNode:null,lastTabbableNode:null,nodeFocusedBeforeActivation:null,mostRecentlyFocusedNode:null,active:!1,paused:!1},o={activate:function(e){if(a.active)return;h(),a.active=!0,a.paused=!1,a.nodeFocusedBeforeActivation=n.activeElement;var t=e&&e.onActivate?e.onActivate:r.onActivate;t&&t();return c(),o},deactivate:s,pause:function(){if(a.paused||!a.active)return;a.paused=!0,u()},unpause:function(){if(!a.paused||!a.active)return;a.paused=!1,h(),c()}};return o;function s(e){if(a.active){clearTimeout(x),u(),a.active=!1,a.paused=!1,C.deactivateTrap(o);var t=e&&void 0!==e.onDeactivate?e.onDeactivate:r.onDeactivate;return t&&t(),(e&&void 0!==e.returnFocus?e.returnFocus:r.returnFocusOnDeactivate)&&L((function(){var e;y((e=a.nodeFocusedBeforeActivation,d("setReturnFocus")||e))})),o}}function c(){if(a.active)return C.activateTrap(o),x=L((function(){y(l())})),n.addEventListener("focusin",v,!0),n.addEventListener("mousedown",f,{capture:!0,passive:!1}),n.addEventListener("touchstart",f,{capture:!0,passive:!1}),n.addEventListener("click",p,{capture:!0,passive:!1}),n.addEventListener("keydown",m,{capture:!0,passive:!1}),o}function u(){if(a.active)return n.removeEventListener("focusin",v,!0),n.removeEventListener("mousedown",f,!0),n.removeEventListener("touchstart",f,!0),n.removeEventListener("click",p,!0),n.removeEventListener("keydown",m,!0),o}function d(e){var t=r[e],i=t;if(!t)return null;if("string"==typeof t&&!(i=n.querySelector(t)))throw new Error("`"+e+"` refers to no known node");if("function"==typeof t&&!(i=t()))throw new Error("`"+e+"` did not return a node");return i}function l(){var e;if(!(e=null!==d("initialFocus")?d("initialFocus"):i.contains(n.activeElement)?n.activeElement:a.firstTabbableNode||d("fallbackFocus")))throw new Error("Your focus-trap needs to have at least one focusable element");return e}function f(e){i.contains(e.target)||(r.clickOutsideDeactivates?s({returnFocus:!S(e.target)}):r.allowOutsideClick&&("boolean"==typeof r.allowOutsideClick?r.allowOutsideClick:r.allowOutsideClick(e))||e.preventDefault())}function v(e){i.contains(e.target)||e.target instanceof Document||(e.stopImmediatePropagation(),y(a.mostRecentlyFocusedNode||l()))}function m(e){if(!1!==r.escapeDeactivates&&function(e){return"Escape"===e.key||"Esc"===e.key||27===e.keyCode}(e))return e.preventDefault(),void s();(function(e){return"Tab"===e.key||9===e.keyCode})(e)&&function(e){if(h(),e.shiftKey&&e.target===a.firstTabbableNode)return e.preventDefault(),void y(a.lastTabbableNode);if(!e.shiftKey&&e.target===a.lastTabbableNode)e.preventDefault(),y(a.firstTabbableNode)}(e)}function p(e){r.clickOutsideDeactivates||i.contains(e.target)||r.allowOutsideClick&&("boolean"==typeof r.allowOutsideClick?r.allowOutsideClick:r.allowOutsideClick(e))||(e.preventDefault(),e.stopImmediatePropagation())}function h(){var e=function(e,t){t=t||{};var n,i,r=[],a=[],o=e.querySelectorAll(w);t.includeContainer&&E.call(e,w)&&(o=Array.prototype.slice.apply(o)).unshift(e);for(var s=0;s<o.length;s++)k(n=o[s])&&(0===(i=T(n))?r.push(n):a.push({documentOrder:s,tabIndex:i,node:n}));return a.sort(A).map((function(e){return e.node})).concat(r)}(i);a.firstTabbableNode=e[0]||l(),a.lastTabbableNode=e[e.length-1]||l()}function y(e){e!==n.activeElement&&(e&&e.focus?(e.focus({preventScroll:!!r.preventScroll}),a.mostRecentlyFocusedNode=e,function(e){return e.tagName&&"input"===e.tagName.toLowerCase()&&"function"==typeof e.select}(e)&&e.select()):y(l()))}}function L(e){return setTimeout(e,0)}const D={name:"FormContainer",props:{structSchema:{type:Object,required:!0},transportFunction:{type:Object,required:!0},options:{type:Object,default:function(){}}},data:function(){return{structModel:null,yupSchema:null,trap:null,isActive:!1,domForm:null,loadingElement:null}},mounted:function(){this.domForm=this.$refs.form,this.initValidatorElements(),this.initTextAreas(),this.initFocusTrap()},methods:{initTextAreas:function(){this.domForm.querySelectorAll("[data-autoresize]").forEach((function(e){e.style.boxSizing="border-box";var t=e.offsetHeight-e.clientHeight;e.addEventListener("input",(function(e){e.target.style.height="auto",e.target.style.height=e.target.scrollHeight+t+"px"})),e.removeAttribute("data-autoresize")}))},initFocusTrap:function(){this.trap=$(this.$refs.form,{clickOutsideDeactivates:!0})},initValidatorElements:function(){var t=this;Object.keys(this.structSchema).map((function(n){var i=t.domForm.querySelector("i[name=".concat(n,"]"));if(i){var r=i.classList.value;new(e.extend(s))({propsData:{name:n}}).$mount(i).$el.className=r}}))},trapFocus:function(){this.isActive||this.trap.activate(),this.isActive=!0},unTrapFocus:function(){this.isActive&&this.trap.deactivate(),this.isActive=!1},validateForm:function(){var e=this;return new Promise((function(t){var n=b(e.$refs.form,{hash:!0}),i=[];Object.keys(e.structSchema).forEach((function(t){var r=(0,e.structSchema[t])(n[t]);!0!==r&&i.push({prop:t,value:r()})})),i.length>0&&(i.forEach((function(t){e.displayValidationErrors(t.prop,t.value)})),t({success:!1,errors:i})),t({success:!0,data:n})}))},displayValidationErrors:function(e,t){var n=this.domForm.querySelector("[data-ntfc=".concat(e,"]"));n&&(n.innerHTML=t,n.style.display="block")},clearValidationErrors:function(e){this.domForm.querySelector("[data-validation-message=".concat(e,"]")).innerHTML=""},toggleSubmitButton:function(e){this.domForm.querySelector("button[type=submit]").disabled=!e},submitForm:function(e){var t=this;e&&e.preventDefault(),this.loadingElement&&"success"===this.loadingElement.state?this.reset():this.validateForm().then(function(){var e=function(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function s(e){i(o,r,a,s,c,"next",e)}function c(e){i(o,r,a,s,c,"throw",e)}s(void 0)}))}}(regeneratorRuntime.mark((function e(n){var i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.success){e.next=9;break}return t.triggerLoadingState("loading"),e.next=4,t.transportFunction.func(n.data);case 4:i=e.sent,t.$bsFormsDebug&&(console.log("BS Forms Transport Function Response:"),console.log(i)),t.transportFunction.success(i)?(t.triggerLoadingState("success"),t.$emit("success",i)):t.$emit("error",i),e.next=10;break;case 9:t.$emit("warning",n.errors);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},triggerLoadingState:function(t){if("loading"===t){this.domForm.querySelector("button[type=submit]").setAttribute("disabled",!0);var n=this.domForm.querySelector("i[name=loading]");if(n){var i=n.classList.value,r=new(e.extend(l));this.loadingElement=r.$mount(n),this.loadingElement.$el.className="".concat(i," bs-form-loading")}}else if("success"===t){this.domForm.querySelector("button[type=submit]").removeAttribute("disabled"),this.loadingElement&&(this.loadingElement.state="success")}},reset:function(){var e=this;this.domForm.reset(),this.domForm.querySelector("button[type=submit]").removeAttribute("disabled");var t=this.domForm.querySelector(".bs-form-loading").classList.value;this.loadingElement.isAlive=!1;this.domForm.querySelector("i[name=loading]");this.$nextTick((function(){e.loadingElement.$el.classList=t,e.loadingElement=null}))}}};var R=function(){var e=this,t=e.$createElement;return(e._self._c||t)("form",{directives:[{name:"click-outside",rawName:"v-click-outside",value:e.unTrapFocus,expression:"unTrapFocus"}],ref:"form",on:{submit:e.submitForm,click:e.trapFocus,focus:e.trapFocus}},[e._t("default")],2)};R._withStripped=!0;const I=r({render:R,staticRenderFns:[]},undefined,D,undefined,false,undefined,!1,void 0,void 0,void 0);var q={install:function(e,t){e.use(n),e.component("bs-form",I),t.debug&&(e.prototype.$bsFormsDebug=!0)}};export default q;
